<?xml version="1.0"?>
<odoo>
    <data noupdate="1">
        <record id="notes_of_meeting" model="mail.template">
            <field name="name">Calendar: Meeting Conclusion</field>
            <field name="email_from">${object.event_id.user_id.email or ''}</field>
            <field name="subject">${object.event_id.name} conclusion</field>
            <field name="model_id" ref="calendar.model_calendar_attendee"/>
            <field name="email_to" >${('' if object.partner_id and object.partner_id.email and object.partner_id.email==object.email else object.email|safe)}</field>
            <field name="partner_to">${object.partner_id and object.partner_id.email and object.partner_id.email==object.email and object.partner_id.id or False }</field>
            <field name="auto_delete" eval="True"/>
            <field name="body_html"><![CDATA[
                <div summary="o_mail_template" style="padding:0px;width:600px;margin:auto;background: #FFFFFF repeat top /100%;color:#777777">
                % set colors = {'needsAction': 'grey', 'accepted': 'green', 'tentative': '#FFFF00',  'declined': 'red'}
                    <table cellspacing="0" cellpadding="0" style="width:600px;border-collapse:collapse;background:inherit;color:inherit">
                        <tbody>
                            <tr>
                                <td valign="center" width="200" style="padding:10px 10px 10px 5px;font-size: 12px">
                                    <img src="/vl_meeting/static/src/logo.jpg" style="padding: 0px; margin: 0px; height: 100px; width: auto;" alt="${user.company_id.name}">
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table cellspacing="0" cellpadding="0" style="width:600px;border-collapse:collapse;background:inherit;color:inherit">
                        <tbody>
                            <tr>
                                <td valign="top" style="width:600px; padding:10px 10px 10px 5px;">
                                    <div>
                                        <hr width="100%" style="background-color:rgb(204,204,204);border:medium none;clear:both;display:block;font-size:0px;min-height:1px;line-height:0;margin:15px auto;padding:0">
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div style="padding:0px;width:600px;margin:auto;background: #FFFFFF repeat top /100%;color:#777777">
                    <table cellspacing="0" cellpadding="0" style="width:600px;border-collapse:collapse;background:inherit;color:inherit">
                        <tbody>
                            <tr>
                                <td style="padding:10px 10px 10px 5px;font-size: 14px;">
                                    <p style="font-size: 20px; text-align: center;">Meeting conclusion for <strong>${object.event_id.name}</strong></p>
                                    <p>
                                        <strong>Dear ${object.common_name}</strong>,<br />
                                        here is the Meeting conclusion for the project ${object.event_id.name}.</p>
                                    <table style="margin-top: 20px;">
                                        <tr>
                                            <td>
                                                <div style="border-top-left-radius:3px;border-top-right-radius:3px;font-size:12px;border-collapse:separate;text-align:center;font-weight:bold;color:#ffffff;width:130px;min-height: 18px;background:#875A7B;padding-top: 4px;">
                                                    ${object.event_id.get_interval('dayname', tz=object.partner_id.tz if not object.event_id.allday else None)}
                                                </div>
                                                <div style="font-size:48px;min-height:auto;font-weight:bold;text-align:center;color: #5F5F5F;background-color: #F8F8F8;width: 130px;border:1px solid #875A7B;">
                                                    ${object.event_id.get_interval('day', tz=object.partner_id.tz if not object.event_id.allday else None)}
                                                </div>
                                                <div style='font-size:12px;text-align:center;font-weight:bold;color:#ffffff;background-color:#875A7B'>${object.event_id.get_interval('month', tz=object.partner_id.tz if not object.event_id.allday else None)}</div>
                                                <div style="border-collapse:separate;color: #5F5F5F;text-align:center;width: 130px;font-size:12px;border-bottom-right-radius:3px;font-weight:bold;border:1px solid #875A7B;border-bottom-left-radius:3px;">${not object.event_id.allday and object.event_id.get_interval('time', tz=object.partner_id.tz) or ''}</div>
                                            </td>
                                            <td width="20px;"/>
                                            <td>
                                                <p>Details of the event</p>
                                                <ul>
                                                    % if object.event_id.location:
                                                    <li>Location: ${object.event_id.location}
                                                    (<a href="http://maps.google.com/maps?oi=map&q=${object.event_id.location}">View Map</a>)
                                                    </li>
                                                    % endif
                                                    % if object.event_id.description :
                                                    <li>Description: ${object.event_id.description}</li>
                                                    % endif
                                                    <li>Attendees
                                                        <ul>
                                                            % for attendee in object.event_id.attendee_ids:
                                                            <li>
                                                                <div style="display:inline-block; border-radius: 50%; width:10px; height:10px;background:${colors[attendee.state] or 'white'};"></div>
                                                                % if attendee.common_name != object.common_name:
                                                                <span style="margin-left:5px">${attendee.common_name}</span>
                                                                % else:
                                                                <span style="margin-left:5px">You</span>
                                                                % endif
                                                            </li>
                                                            % endfor
                                                        </ul>
                                                    </li>
                                                    <li>Meeting conclusion
                                                        <ul>
                                                            % if object.event_id.meeting_notes :
                                                            <li>${object.event_id.meeting_notes}</li>
                                                            % endif
                                                        </ul>
                                                    </li>
                                                </ul>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>]]>
            </field>
        </record>
    </data>
</odoo>
